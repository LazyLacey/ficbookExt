"use strict";(self.webpackChunkficbook=self.webpackChunkficbook||[]).push([[138],{7138:(e,s,a)=>{a.r(s),a.d(s,{default:()=>Z});var l=a(1101),r=a(4569),i=a(1275);let t={class:"fanfic-roles"},o={class:"fanfic-roles-buttons"},n=["disabled"],c=["disabled"],d=["disabled"],u={class:"user-selector"},f={class:"fanfic-roles-list-title"};var m=a(1764),p=a.n(m),v=a(2967),h=a(7742),g=a(8032);let b={class:"fanfic-role"},_={class:"fanfic-role-info"},k={class:"fanfic-role-avatar"},w={class:"img-holder-universal avatar-40"},y={class:"avatar-cropper"},R=["src"],I={class:"fanfic-role-user"},z={class:"d-flex flex-wrap"},C=["href"],D={class:"fanfic-role-status"},L={key:0,class:"unconfirmed"},T={key:1,class:"unconfirmed"},S={key:2,class:"confirmed"},q={class:"design-checkbox design-checkbox--normal design-checkbox--mini"},x=["checked","value","name"],O=["name","value"],A=(0,l.aZ)({__name:"fanfic-role",props:{user:{},roleType:{}},emits:["remove"],setup(e,s){let{emit:a}=s;return(e,s)=>((0,l.wg)(),(0,l.iD)("div",b,[(0,l._)("div",_,[(0,l._)("div",k,[(0,l._)("div",w,[(0,l._)("div",y,[(0,l._)("img",{src:e.user.avatar_path,alt:""},null,8,R)])])]),(0,l._)("div",I,[(0,l._)("div",z,[(0,l._)("a",{href:"/authors/"+e.user.slug,class:"user-link",target:"_blank"},(0,r.zw)(e.user.username),9,C),(0,l._)("div",D,[void 0===e.user.confirmed?((0,l.wg)(),(0,l.iD)("span",L,(0,r.zw)(v.t("fanfic-roles-selector.request")),1)):(0,l.kq)("v-if",!0),!1===e.user.confirmed?((0,l.wg)(),(0,l.iD)("span",T,(0,r.zw)(v.t("fanfic-roles-selector.rejection")),1)):(0,l.kq)("v-if",!0),!0===e.user.confirmed?((0,l.wg)(),(0,l.iD)("span",S,(0,r.zw)(v.t("fanfic-roles-selector.confirm")),1)):(0,l.kq)("v-if",!0)])]),(0,l._)("label",q,[(0,l._)("input",{checked:void 0===e.user.can_edit||e.user.can_edit,value:e.user.id,type:"checkbox",name:e.roleType+"_ids_can_edit[]"},null,8,x),(0,l.Uk)(" "+(0,r.zw)(v.t("fanfic-roles-selector.allow-fic-editing")),1)])]),(0,l._)("div",{onClick:s[0]||(s[0]=e=>a("remove")),class:"fanfic-role-remove-button icon-clickable"},[(0,l.Wm)(g.Z,{"icon-name":"ic_cancel-circle",class:"icon-cancel-color"})])]),(0,l._)("input",{type:"hidden",name:e.roleType+"_ids_all[]",value:e.user.id},null,8,O)]))}}),E=(0,l.aZ)({name:"fanfic-roles-selector",components:{FanficRole:A,AuthorSelector:h.Z},props:{userId:{type:Number,required:!0},preselectBetas:{type:Array,default:()=>[]},preselectCoauthors:{type:Array,default:()=>[]},preselectGammas:{type:Array,default:()=>[]}},data(){return{i18n:v,ROLES_LIMIT:5,addingRole:"",roles:{coauthor:this.preselectCoauthors,beta:this.preselectBetas,gamma:this.preselectGammas}}},methods:{addRole(e){this.addingRole=this.addingRole===e?"":e},selectUser(e){if(e.id==this.userId){p().warning(v.t("fanfic-roles-selector.you-are-already-an-author"));return}let s=Object.values(this.roles).some(s=>s.some(s=>s.id==e.id));if(s){p().warning(`${e.username} ${v.t("fanfic-roles-selector.in-list")}`);return}this.roles[this.addingRole].push(e),this.addingRole=""},removeRole(e,s){this.roles[e].splice(s,1)}}});var M=a(1334);let U=(0,M.Z)(E,[["render",function(e,s,a,m,p,v){let h=(0,l.up)("AuthorSelector"),g=(0,l.up)("FanficRole");return(0,l.wg)(),(0,l.iD)("div",t,[(0,l._)("div",o,[(0,l._)("button",{onClick:s[0]||(s[0]=s=>e.addRole("coauthor")),disabled:e.roles.coauthor.length>=e.ROLES_LIMIT,class:(0,r.C_)([{active:"coauthor"===e.addingRole},"ds-btn ds-btn-mini ds-btn-regular"]),type:"button"},(0,r.zw)(e.i18n.t("fanfic-roles-selector.add-coauthor")),11,n),(0,l._)("button",{onClick:s[1]||(s[1]=s=>e.addRole("beta")),disabled:e.roles.beta.length>=e.ROLES_LIMIT,class:(0,r.C_)([{active:"beta"===e.addingRole},"ds-btn ds-btn-mini ds-btn-regular"]),type:"button"},(0,r.zw)(e.i18n.t("fanfic-roles-selector.add-beta")),11,c),(0,l._)("button",{onClick:s[2]||(s[2]=s=>e.addRole("gamma")),disabled:e.roles.gamma.length>=e.ROLES_LIMIT,class:(0,r.C_)([{active:"gamma"===e.addingRole},"ds-btn ds-btn-mini ds-btn-regular"]),type:"button"},(0,r.zw)(e.i18n.t("fanfic-roles-selector.add-gamma")),11,d)]),(0,l.wy)((0,l._)("div",u,[(0,l.Wm)(h,{"clear-on-select":"","onUpdate:modelValue":e.selectUser},null,8,["onUpdate:modelValue"])],512),[[i.F8,e.addingRole]]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.roles,(s,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a,class:"fanfic-roles-list"},[s.length?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l._)("div",f,(0,r.zw)(e.i18n.t(`fanfic-roles-selector.${a}`))+" "+(0,r.zw)(s.length)+"/"+(0,r.zw)(e.ROLES_LIMIT),1),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s,(s,r)=>((0,l.wg)(),(0,l.iD)("div",{key:s.id,class:"fanfic-role"},[(0,l.Wm)(g,{user:s,roleType:a,onRemove:s=>e.removeRole(a,r)},null,8,["user","roleType","onRemove"])]))),128))],64)):(0,l.kq)("v-if",!0)]))),128))])}]]),Z=U}}]);